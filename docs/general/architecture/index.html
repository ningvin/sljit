<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-general/architecture" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Architecture | SLJIT</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://zherczeg.github.com/sljit/docs/general/architecture"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Architecture | SLJIT"><meta data-rh="true" name="description" content="The inner workings of SLJIT."><meta data-rh="true" property="og:description" content="The inner workings of SLJIT."><link data-rh="true" rel="canonical" href="https://zherczeg.github.com/sljit/docs/general/architecture"><link data-rh="true" rel="alternate" href="https://zherczeg.github.com/sljit/docs/general/architecture" hreflang="en"><link data-rh="true" rel="alternate" href="https://zherczeg.github.com/sljit/docs/general/architecture" hreflang="x-default"><link rel="stylesheet" href="/sljit/assets/css/styles.d47d9584.css">
<script src="/sljit/assets/js/runtime~main.c304afc2.js" defer="defer"></script>
<script src="/sljit/assets/js/main.59db08b5.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/sljit/"><b class="navbar__title text--truncate">SLJIT</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/sljit/docs/general/introduction">Docs</a><a class="navbar__item navbar__link" href="/sljit/docs/tutorial/overview">Tutorial</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/zherczeg/sljit" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar--github-link" aria-label="GitHub"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sljit/docs/general/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/sljit/docs/category/getting-started">Getting Started</a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/sljit/docs/general/architecture">Architecture</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/sljit/docs/category/use-cases">Use Cases</a><button aria-label="Expand sidebar category &#x27;Use Cases&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sljit/docs/general/contributing">Contributing</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/sljit/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Architecture</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Architecture</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="low-level-intermediate-representation">Low-level Intermediate Representation<a href="#low-level-intermediate-representation" class="hash-link" aria-label="Direct link to Low-level Intermediate Representation" title="Direct link to Low-level Intermediate Representation">â€‹</a></h2>
<p>Defining a LIR which provides wide range of optimization opportunities and still can be efficiently translated to machine code on all CPUs is the biggest challenge of this project.
Those instruction forms and features which are supported on many (but not necessarily on all) architectures are carefully selected and a LIR is created from them.
These features are also emulated by the remaining architectures with low overhead.
For example, SLJIT supports various memory addressing modes and setting status register bits.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="generic-cpu-model">Generic CPU Model<a href="#generic-cpu-model" class="hash-link" aria-label="Direct link to Generic CPU Model" title="Direct link to Generic CPU Model">â€‹</a></h2>
<p>The CPU has:</p>
<ul>
<li>integer registers, which can store either an <code>int32_t</code> (4 byte) or <code>intptr_t</code> (4 or 8 byte) value</li>
<li>floating point registers, which can store either a single (4 byte) or double (8 byte) precision value</li>
<li>boolean status flags</li>
</ul>
<p>Some platforms additionally have support for vector registers, which may alias the floating point registers.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="integer-registers">Integer Registers<a href="#integer-registers" class="hash-link" aria-label="Direct link to Integer Registers" title="Direct link to Integer Registers">â€‹</a></h3>
<p>The most important rule is: when a source operand of an instruction is a register, the data type of the register must match the data type expected by an instruction.</p>
<p>For example, the following code snippet is a valid instruction sequence:</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sljit_emit_op1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">compiler</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SLJIT_MOV32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SLJIT_R0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SLJIT_MEM1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SLJIT_R1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// An int32_t value is loaded into SLJIT_R0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sljit_emit_op1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">compiler</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SLJIT_REV32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SLJIT_R0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SLJIT_R0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// the int32_t value in SLJIT_R0 is byte swapped</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// and the type of the result is still int32_t</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The next code snippet is not allowed:</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sljit_emit_op1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">compiler</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SLJIT_MOV</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SLJIT_R0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SLJIT_MEM1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SLJIT_R1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// An intptr_t value is loaded into SLJIT_R0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sljit_emit_op1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">compiler</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SLJIT_REV32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SLJIT_R0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SLJIT_R0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// The result of the instruction is undefined.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Even crash is possible for some instructions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// (e.g. on MIPS-64).</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>However, it is always allowed to overwrite a register regardless of its previous value:</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sljit_emit_op1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">compiler</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SLJIT_MOV</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SLJIT_R0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SLJIT_MEM1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SLJIT_R1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// An intptr_t value is loaded into SLJIT_R0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sljit_emit_op1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">compiler</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SLJIT_MOV32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SLJIT_R0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SLJIT_MEM1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SLJIT_R2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// From now on SLJIT_R0 contains an int32_t</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// value. The previous value is discarded.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Type conversion instructions are provided to convert an <code>int32_t</code> value to an <code>intptr_t</code> value and vice versa.
In certain architectures these conversions are <em>nops</em> (no instructions are emitted).</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="memory-accessing">Memory Accessing<a href="#memory-accessing" class="hash-link" aria-label="Direct link to Memory Accessing" title="Direct link to Memory Accessing">â€‹</a></h4>
<p>Register arguments of <code>SLJIT_MEM1</code> / <code>SLJIT_MEM2</code> addressing modes must contain <code>intptr_t</code> data.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="signed--unsigned-values">Signed / Unsigned Values<a href="#signed--unsigned-values" class="hash-link" aria-label="Direct link to Signed / Unsigned Values" title="Direct link to Signed / Unsigned Values">â€‹</a></h4>
<p>Most operations are executed in the same way regardless of if the value is signed or unsigned.
These operations have only one instruction form (e.g. <code>SLJIT_ADD</code> / <code>SLJIT_MUL</code>).
Instructions where the result depends on the sign have two forms (e.g. integer division, long multiply).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="floating-point-registers">Floating Point Registers<a href="#floating-point-registers" class="hash-link" aria-label="Direct link to Floating Point Registers" title="Direct link to Floating Point Registers">â€‹</a></h3>
<p>Floating point registers can either contain a single or double precision value.
Similar to integer registers, the data type of the value stored in a source register must match the data type expected by the instruction.
Otherwise the result is undefined (even a crash is possible).</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="rounding">Rounding<a href="#rounding" class="hash-link" aria-label="Direct link to Rounding" title="Direct link to Rounding">â€‹</a></h4>
<p>Similar to standard C, floating point computation results are rounded toward zero.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="boolean-status-flags">Boolean Status Flags<a href="#boolean-status-flags" class="hash-link" aria-label="Direct link to Boolean Status Flags" title="Direct link to Boolean Status Flags">â€‹</a></h3>
<p>Conditional branches usually depend on the value of CPU status flags.
These status flags are boolean values and can be set by certain instructions.</p>
<p>For better compatibility with CPUs without flags, SLJIT exposes only two such flags:</p>
<ul>
<li>The <strong>zero</strong> (or equal) flag is set if <code>SLJIT_SET_Z</code> was specified and the result is zero.</li>
<li>The <strong>variable</strong> flag&#x27;s meaning depends on the arithmetic operation that sets it, as well as the type of flag requested. For example, <code>SLJIT_ADD</code> supports setting the <code>Z</code>, <code>CARRY</code> and <code>OVERFLOW</code> flags. The latter two will however both map to the variable flag and can thus not be requested at the same time.</li>
</ul>
<p>Be aware that different operations give different guarantees on what state the flags will be in afterwards.
Also, not all flags are supported by all operations.
For more details, refer to <a href="https://github.com/zherczeg/sljit/blob/master/sljit_src/sljitLir.h" target="_blank" rel="noopener noreferrer"><code>sljitLir.h</code></a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="complex-instructions">Complex Instructions<a href="#complex-instructions" class="hash-link" aria-label="Direct link to Complex Instructions" title="Direct link to Complex Instructions">â€‹</a></h2>
<p>We noticed that introducing complex instructions for common tasks can improve performance.
For example, compare and branch instruction sequences can be optimized if certain conditions apply, but these conditions depend on the target CPU.
SLJIT can do these optimizations, but it needs to understand the &quot;purpose&quot; of the generated code.
Static instruction analysis has a large performance overhead however, so we chose another approach: we introduced complex instruction forms for certain non-atomic tasks.
SLJIT can optimize these instructions more efficiently since their purpose is known to the compiler.
These complex instruction forms can often be assembled from other SLJIT instructions, but we recommended to use them since the compiler can optimize them on certain CPUs.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="generating-functions">Generating Functions<a href="#generating-functions" class="hash-link" aria-label="Direct link to Generating Functions" title="Direct link to Generating Functions">â€‹</a></h2>
<p>SLJIT is often used for generating function bodies which are
called from C.
SLJIT provides two complex instructions for generating function entry and return: <code>sljit_emit_enter</code> and <code>sljit_emit_return</code>.
The <code>sljit_emit_enter</code> function also initializes the compilation context, which specifies the current register mapping, local space size and other configurations.
The <code>sljit_set_context</code> function can also set this context without emitting any machine instructions.</p>
<p>This context is important since it affects the compiler, so the first instruction after a compiler is created must be either <code>sljit_emit_enter</code> or <code>sljit_set_context</code>.
The context can be changed by calling <code>sljit_emit_enter</code> or <code>sljit_set_context</code> again.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="types">Types<a href="#types" class="hash-link" aria-label="Direct link to Types" title="Direct link to Types">â€‹</a></h2>
<p>SLJIT defines several types for representing data on the target platform, often times in both a signed and unsigned variant:</p>
<ul>
<li>Integers of varying size: <code>sljit_s8</code> / <code>sljit_u8</code>, <code>sljit_s16</code> / <code>sljit_u16</code>, <code>sljit_s32</code> / <code>sljit_u32</code></li>
<li>Machine word, capable of holding a pointer: <code>sljit_sw</code> / <code>sljit_uw</code>, <code>sljit_sp</code> / <code>sljit_up</code></li>
<li>Floating point types: <code>f32</code>, <code>f64</code></li>
</ul>
<p>It is recommended to use these types instead of the default C types such as <code>long</code>, as it improves both the readability and the portability of the code.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/zherczeg/sljit/docs/docs/../general/architecture.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/sljit/docs/general/getting-started/configuration"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Configuration</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/sljit/docs/category/use-cases"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Use Cases</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#low-level-intermediate-representation" class="table-of-contents__link toc-highlight">Low-level Intermediate Representation</a></li><li><a href="#generic-cpu-model" class="table-of-contents__link toc-highlight">Generic CPU Model</a><ul><li><a href="#integer-registers" class="table-of-contents__link toc-highlight">Integer Registers</a></li><li><a href="#floating-point-registers" class="table-of-contents__link toc-highlight">Floating Point Registers</a></li><li><a href="#boolean-status-flags" class="table-of-contents__link toc-highlight">Boolean Status Flags</a></li></ul></li><li><a href="#complex-instructions" class="table-of-contents__link toc-highlight">Complex Instructions</a></li><li><a href="#generating-functions" class="table-of-contents__link toc-highlight">Generating Functions</a></li><li><a href="#types" class="table-of-contents__link toc-highlight">Types</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Content</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/sljit/docs/general/introduction">Docs</a></li><li class="footer__item"><a class="footer__link-item" href="/sljit/docs/tutorial/overview">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/zherczeg/sljit" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Attribution</div><ul class="footer__items clean-list"><li class="footer__item">
                  <span>
                    <a href="https://www.figma.com/community/file/1166831539721848736/solar-icons-set">
                      Solar Icon Set
                    </a>
                    by
                    <a href="https://www.figma.com/@480design">
                      480 Design
                    </a>
                    and
                    <a href="https://www.figma.com/@voidrainbow">
                      R4IN80W
                    </a>
                    |
                    <a href="http://creativecommons.org/licenses/by/4.0/">
                      CC BY 4.0
                    </a>
                  </span>
                </li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2025 SLJIT contributors. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>